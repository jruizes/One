class MapController < ApplicationController


def initialize
  @a = Array.new
#Toda la linea B del metro
#@a=["40026","40025","40024","40023","40022","40021","40020","40019","40018","40017","40016","40015","40014","40013","40012","40011","40010","40009","40008","40007","40006","40005","40004","40003","40002","40001","40000","39999","39998","39997","39996","39995","39994","39993","39992","39991","39990","39989","39988","39987","39986","39985","39984","39983","39982","39981","39980","39979","39978","39977","39976","39975","39974","39973","39972","39971","39970","39969","39968","39967","39966","39965","39964","39963","39962","39961","39960","39959","39958","39957","39956","39955","39954","39953","39952","39951","39950","39949","39948","39947","39946","39945","39944","39943","39942","39941","39940","39939","39938","39937","39936","39935","39934","39933","39932","39931","39930","39929","39928","39927","39926","39925","39924","39923","39922","39921","39920","39919","39918","39917","39916"]

#Una estación del metro
#@a=["40026","40025","40024","40023","40022","40021","40020","40019","40018","40017","40016","40015","40014","40013","40012","40011","40010","40009","40008","40007","40006","40005","40004","40003","40002","40001","40000","39999","39998","39997","39996","18179", "18292"]

#Trayecto de prueba del metro
#@a=["40026","40025","40024","40023","40022","40021","40020","40019","39996","39995"]
@a=[20235, 20236, 19925, 19590, 19468, 19388, 19352, 19158, 18942, 18943, 18799, 18877, 18710, 18711, 18776, 18891, 19064, 18988, 18987, 19020, 19178, 19042, 19091, 18898, 18692, 18569, 18464, 18324, 18182, 18091, 18246, 18297, 18339, 18358, 18192, 18193, 18125, 17620, 17300, 17235, 17116, 16912, 16779, 16781, 16596, 16117, 15964, 15679, 15498, 15401, 15083, 14690, 14692, 14416, 14356, 14341, 14308, 14282, 14040, 13976, 13951, 13903, 13800, 13552, 13510, 13361, 13330, 13190, 13163, 13001, 13081, 13127, 13116, 13137, 13347, 13344, 13538, 13941, 13882, 13827, 13762, 13705, 13915, 13914, 13817, 13759, 13709, 13575, 13550, 13439, 13267, 13004, 12896, 12680, 12527, 12432, 12440, 12282, 12283, 12130, 11982, 11826, 11813, 11696, 11617, 11618, 11616, 11605, 11462, 11249, 11086, 10944, 10941, 10943, 11078, 11074, 11070, 11069, 10921, 10911, 10902, 10901, 10900, 10906, 10896, 10898, 10816, 10793, 10788, 10784, 10733, 10550, 10552, 10539, 10407, 10273, 10196, 10191, 10031, 10032, 10023, 10017, 9637, 9483, 9475, 9476, 9329, 9340, 9333, 9391, 9398, 9377, 9631, 9607, 9710, 9929, 9937, 9930, 9916, 9773, 9758, 9750, 9740, 9579, 9722, 9792, 9791, 9801, 10289, 10513, 10690, 10881, 11079, 11060, 11058, 11046, 11030, 11027, 11022, 10919, 10920, 10764, 10516, 10421, 10201, 9842, 9606, 9605, 9401, 9239, 9217, 9221, 8940, 8925, 8909, 8672, 8673, 8655, 8529, 8499, 8374, 8323, 8305, 8293, 8302, 8287, 8041, 7944, 7841, 7811, 7775, 7707, 7583, 7536, 7537, 7531, 7526, 7520, 7500, 7499, 7549, 7487, 7489, 7413, 7328, 7327, 7303, 7256, 7249, 7255, 7091, 7035, 7045, 7049, 7008, 6955, 6904, 6860, 6836, 6648, 6650, 6644, 6499]

  #@a = ["1","3","6","14","18","21","24","27","23","28","25","34","36","48"]
  #@a = ["1","3","6","14","18","21","24","22","17","10","11","16","20","15","27","23","28","25","34","36","48"]
@init_point
@end_point
end

def calcular

  params_initial_point = params[:initial_point]
  params_end_point = params[:end_point]
  lat_start,long_start = params_initial_point.split(/,/)
  lat_end,long_end = params_end_point.split(/,/)
  closest_init_point = Roadmap.get_closest_init_point(lat_start,long_start)
  if(closest_init_point.empty?)
    res={:success=>false, :content=>"Debe de elegir un punto inicial más cercano"}
    render :text=>res.to_json
  else
    closest_end_point = Roadmap.get_closest_end_point(lat_end,long_end)
    if(closest_end_point.empty?)
      res={:success=>false, :content=>"Debe de elegir un punto final más cercano"}
      render :text=>res.to_json
    else
      resultadoquery = metodoruta(lat_start,long_start,lat_end,long_end)
      res={:success=>true, :content=>resultadoquery}
      render :text=>res.to_json
    end
  end
end


def metodoruta(lat_start,long_start,lat_end,long_end)
  resultado = Roadmap.getRoute(@a,lat_start,long_start,lat_end,long_end)
  resultado
end

def calcularRuta
end

end

